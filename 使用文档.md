# Chat2Table 使用文档

## 环境要求
- Python 3.8+
- 阿里云通义千问API密钥（DASHSCOPE_API_KEY）

## 安装步骤
1. 克隆项目到本地
2. 安装依赖包：
```bash
pip install -r requirements.txt
```
3. 配置API密钥：
   - 方式1：设置环境变量 `DASHSCOPE_API_KEY`
   - 方式2：在项目根目录创建 `.env` 文件，添加 `DASHSCOPE_API_KEY=your_key`

## 使用方法

### 1. 处理本地文件
1. 在项目根目录创建 `input` 文件夹
2. 将需要处理的文件放入 `input` 文件夹
3. 支持的文件格式：
   - 图片文件：jpg、jpeg、png、gif、bmp（不区分大小写）
   - PDF文件：pdf（不区分大小写）
4. 运行程序：
```bash
python main.py
```
5. 处理结果将保存在 `output` 文件夹中

### 2. 处理在线图片
1. 直接运行程序：
```bash
python main.py
```
2. 当 `input` 文件夹为空时，程序会提示输入图片URL
3. 输入以 `http://` 或 `https://` 开头的图片URL
4. 处理结果将保存在 `output` 文件夹中

## 输出说明

### 输出格式
- 默认输出JSON格式文件
- 支持输出TXT格式文件（通过修改代码中的 `output_format` 参数）

### 输出内容
1. JSON格式：
```json
{
    "image_url": "图片URL或文件路径",
    "original_pdf": true/false,  // 是否为PDF转换的图片
    "page_number": 页码,         // PDF页码（仅PDF文件）
    "recognition_result": "识别结果",
    "analysis_result": "分析结果",
    "parsed_analysis": {}        // 解析后的分析结果
}
```

2. TXT格式：
```
图像URL: [图片URL或文件路径]
PDF页码: [页码]（仅PDF文件）
=== 识别结果 ===
[识别结果内容]
=== 分析结果 ===
[分析结果内容]
```

### 识别内容说明
1. 单据信息：
   - 单据标题、日期、编号、类型
   - 单据备注、货主信息、仓库信息

2. 表格信息：
   - 表格结构（表头、行数、列数）
   - 表格内容（按行列结构提取）
   - 合并单元格说明
   - 单位说明
   - 特殊格式说明

3. 其他信息：
   - 多表格说明
   - 跨页表格说明
   - 数据单位说明
   - 特殊格式说明

## 使用约束

### 输入限制
1. 文件大小：
   - 单个图片文件不超过10MB
   - 单个PDF文件不超过50MB
   - PDF文件页数不超过100页

2. 图片格式：
   - 支持的图片格式：JPG、JPEG、PNG、GIF、BMP
   - 图片分辨率建议不超过4096x4096

3. PDF文件：
   - 仅支持文本型PDF，不支持扫描版PDF
   - 建议使用清晰度较高的PDF文件

### 输出限制
1. 输出目录：
   - 默认输出到 `output` 文件夹
   - 确保程序对输出目录有写入权限

2. 文件命名：
   - 本地图片：使用原文件名
   - PDF转换：使用 `pdf_page_页码` 格式
   - 在线图片：使用时间戳命名

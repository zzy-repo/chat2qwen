# Chat2Table 使用文档

## 环境要求
- Python 3.8+
- 阿里云通义千问API密钥（DASHSCOPE_API_KEY）

## 安装步骤
1. 克隆项目到本地
2. 安装依赖包：
```bash
pip install -r requirements.txt
```
3. 配置API密钥：
   - 方式1：设置环境变量 `DASHSCOPE_API_KEY`
   - 方式2：在项目根目录创建 `.env` 文件，添加 `DASHSCOPE_API_KEY=your_key`

## 使用方法

### 1. 使用命令行参数
1. 处理在线图片：
```bash
python main.py --url "https://example.com/image.jpg"
```

2. 处理Base64编码的图片数据：
```bash
python main.py --image "base64_encoded_image_data"
```

3. 从标准输入读取：
```bash
# 输入URL
echo "https://example.com/image.jpg" | python main.py

# 输入Base64编码的图片数据
cat image.jpg | base64 | python main.py
```

4. 使用流式输出：
```bash
python main.py --url "https://example.com/image.jpg" --stream
```

### 2. 命令行参数说明
- `--url`: 指定图片URL
- `--image`: 指定Base64编码的图片数据
- `--stream`: 启用流式输出

使用 `--help` 参数可以查看完整的帮助信息：
```bash
python main.py --help
```

输出示例：
```
usage: main.py [-h] [--url URL] [--image IMAGE] [--stream]

图片分析工具

options:
  -h, --help     显示帮助信息并退出
  --url URL      指定图片URL（http/https）
  --image IMAGE  指定Base64编码的图片数据
  --stream       启用流式输出模式

示例：
  # 处理在线图片
  python main.py --url "https://example.com/image.jpg"
  
  # 处理Base64编码的图片
  python main.py --image "base64_encoded_image_data"
  
  # 使用流式输出
  python main.py --url "https://example.com/image.jpg" --stream
  
  # 从标准输入读取
  echo "https://example.com/image.jpg" | python main.py
```

## 输出说明

### 输出格式
- 默认输出JSON格式
- 分析结果会直接打印到控制台

### 输出内容
1. JSON格式：
```json
{
    "image_url": "图片URL",
    "recognition_result": "识别结果",
    "analysis_result": "分析结果",
    "parsed_analysis": {}        // 解析后的分析结果
}
```

### 识别内容说明
1. 单据信息：
   - 单据标题、日期、编号、类型
   - 单据备注、货主信息、仓库信息

2. 表格信息：
   - 表格结构（表头、行数、列数）
   - 表格内容（按行列结构提取）
   - 合并单元格说明
   - 单位说明
   - 特殊格式说明

3. 其他信息：
   - 多表格说明
   - 跨页表格说明
   - 数据单位说明
   - 特殊格式说明

## 使用约束

### 输入限制
1. 图片格式：
   - 支持的图片格式：JPG、JPEG、PNG、GIF、BMP
   - 图片分辨率建议不超过4096x4096
   - 单个图片文件不超过10MB

2. URL限制：
   - 必须使用http或https协议
   - URL必须可公开访问
   - 建议使用HTTPS协议
